image:
  repository: ghcr.io/mealie-recipes/mealie
  tag: latest
  pullPolicy: Always

env:
  # Database configuration - using external postgres
  DB_ENGINE: postgres
  POSTGRES_SERVER: mealie-postgres
  POSTGRES_PORT: "5432"
  POSTGRES_USER:
    valueFrom:
      secretKeyRef:
        name: mealie-credentials
        key: db-user
  POSTGRES_PASSWORD:
    valueFrom:
      secretKeyRef:
        name: mealie-credentials
        key: db-password
  POSTGRES_DB:
    valueFrom:
      secretKeyRef:
        name: mealie-credentials
        key: db
  # Application configuration
  BASE_URL: https://mealie.apocalypso.xyz
  PUID: "1000"
  PGID: "1000"
  TZ: America/New_York
  MAX_WORKERS: "2"
  WEB_CONCURRENCY: "1"

persistence:
  data:
    enabled: true
    type: pvc
    size: 50Gi
    storageClass: nfs
    accessMode: ReadWriteOnce
    mountPath: /app/data

ingress:
  main:
    enabled: true
    ingressClassName: nginx
    hosts:
      - host: mealie.apocalypso.xyz
        paths:
          - path: /
            pathType: Prefix
    tls:
      - hosts:
          - mealie.apocalypso.xyz
        secretName: mealie-tls
    annotations:
      cert-manager.io/cluster-issuer: letsencrypt-prod
      nginx.ingress.kubernetes.io/backend-protocol: HTTP
      external-dns.alpha.kubernetes.io/controller: "false"
      gethomepage.dev/enabled: "true"
      gethomepage.dev/group: User Services
      gethomepage.dev/name: Mealie
      gethomepage.dev/icon: mealie
      gethomepage.dev/description: Meal Planning

resources:
  limits:
    cpu: 1000m
    memory: 2Gi
  requests:
    cpu: 200m
    memory: 512Mi
